(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29860,        599]
NotebookOptionsPosition[     29606,        585]
NotebookOutlinePosition[     29959,        601]
CellTagsIndexPosition[     29916,        598]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"UCENumber", "=", 
     RowBox[{"{", 
      RowBox[{
      "311164", ",", "311389", ",", "311795", ",", "311854", ",", "31249", 
       ",", "31275", ",", "31282", ",", "313240", ",", "313259", ",", 
       "313268", ",", "313319", ",", "313359", ",", "313442", ",", "313462", 
       ",", "31355", ",", "31358", ",", "313775", ",", "313900", ",", 
       "314013", ",", "314110", ",", "314113", ",", "314118", ",", "314124", 
       ",", "314134", ",", "314142", ",", "314452", ",", "314481", ",", 
       "314486", ",", "314507", ",", "315081", ",", "315332", ",", "315388", 
       ",", "315480", ",", "316077", ",", "316142", ",", "316263", ",", 
       "316747", ",", "316816", ",", "316852", ",", "316971", ",", "317211", 
       ",", "317431", ",", "317448", ",", "317492", ",", "317609", ",", 
       "317616", ",", "317623", ",", "317628", ",", "317666", ",", "317699", 
       ",", "317712", ",", "317720", ",", "317721", ",", "317735", ",", 
       "317752", ",", "317769", ",", "317781", ",", "317792", ",", "317838", 
       ",", "317851", ",", "317858", ",", "317860", ",", "317885", ",", 
       "317991", ",", "318121", ",", "318160", ",", "318203", ",", "318256", 
       ",", "318421", ",", "318433", ",", "3186", ",", "318767", ",", "3187", 
       ",", "3188", ",", "318906", ",", "318928", ",", "318940", ",", 
       "319568", ",", "3196", ",", "319938", ",", "319987", ",", "319997", 
       ",", "320013", ",", "3204", ",", "32053", ",", "320620", ",", "3209", 
       ",", "321165", ",", "321172", ",", "3211", ",", "321510", ",", 
       "321516", ",", "321531", ",", "321533", ",", "321535", ",", "321547", 
       ",", "321549", ",", "321562", ",", "321577", ",", "321798", ",", 
       "321826", ",", "321930", ",", "321949", ",", "321951", ",", "321994", 
       ",", "321999", ",", "322024", ",", "322070", ",", "3226", ",", 
       "322779", ",", "322800", ",", "322943", ",", "322983", ",", "323027", 
       ",", "323042", ",", "323321", ",", "323532", ",", "323549", ",", 
       "323724", ",", "3245", ",", "324603", ",", "324750", ",", "324787", 
       ",", "324860", ",", "324898", ",", "324921", ",", "324926", ",", 
       "325095", ",", "325108", ",", "325156", ",", "32723", ",", "32724", 
       ",", "32726", ",", "32728", ",", "32733", ",", "32737", ",", "32740", 
       ",", "32742", ",", "32745", ",", "3281", ",", "328", ",", "3293", ",", 
       "32978", ",", "32981", ",", "32999", ",", "3299", ",", "3300", ",", 
       "33016", ",", "33099", ",", "33107", ",", "33109", ",", "33116", ",", 
       "33158", ",", "33174", ",", "33177", ",", "33244", ",", "33247", ",", 
       "33298", ",", "3338", ",", "3349", ",", "3351", ",", "3353", ",", 
       "3360", ",", "3371", ",", "33780", ",", "3378", ",", "3388", ",", 
       "3413312", ",", "3413327", ",", "3413336", ",", "3413345", ",", 
       "3413346", ",", "3413385", ",", "3413410", ",", "3413414", ",", 
       "3413434", ",", "3413451", ",", "3413522", ",", "3413533", ",", 
       "3413539", ",", "3413544", ",", "3413545", ",", "3413554", ",", 
       "3413570", ",", "3413588", ",", "3413595", ",", "3413602", ",", 
       "3413620", ",", "3413625", ",", "3413671", ",", "3413673", ",", 
       "3413690", ",", "3413709", ",", "3413722", ",", "3413723", ",", 
       "3413725", ",", "3413729", ",", "3451", ",", "3454", ",", "3457", ",", 
       "3474", ",", "3476", ",", "3491", ",", "3509", ",", "3510691", ",", 
       "3510699", ",", "3510754", ",", "3510758", ",", "3510824", ",", 
       "3511287", ",", "351144", ",", "3511650", ",", "3511655", ",", 
       "3511659", ",", "3513094", ",", "35134", ",", "3514208", ",", 
       "3514427", ",", "3514460", ",", "3514545", ",", "3514584", ",", "3520",
        ",", "35328", ",", "3533", ",", "35447", ",", "3544", ",", "35450", 
       ",", "35455", ",", "35470", ",", "35478", ",", "35482", ",", "35514", 
       ",", "35519", ",", "35520", ",", "35522", ",", "35529", ",", "35533", 
       ",", "35536", ",", "35552", ",", "355532", ",", "35553", ",", "35556", 
       ",", "35559", ",", "35577", ",", "35587", ",", "35601", ",", "356036", 
       ",", "35605", ",", "356062", ",", "356107", ",", "356430", ",", 
       "35644", ",", "356564", ",", "356574", ",", "356575", ",", "356612", 
       ",", "35661", ",", "356659", ",", "356695", ",", "356703", ",", 
       "356724", ",", "356727", ",", "356739", ",", "356755", ",", "356766", 
       ",", "356769", ",", "356778", ",", "356784", ",", "356799", ",", 
       "35691", ",", "35743", ",", "35751", ",", "35766", ",", "35768", ",", 
       "357751", ",", "35776", ",", "35777", ",", "35785", ",", "357904", ",",
        "35801", ",", "35815", ",", "35845", ",", "35848", ",", "35854", ",", 
       "35857", ",", "35862", ",", "35873", ",", "35877", ",", "35893", ",", 
       "35894", ",", "358981", ",", "35901", ",", "35904", ",", "35918", ",", 
       "35924", ",", "35934", ",", "35939", ",", "36098", ",", "36111", ",", 
       "36112", ",", "36118", ",", "36119", ",", "36122", ",", "36132", ",", 
       "36178", ",", "36220", ",", "36223", ",", "36231", ",", "36253", ",", 
       "36255", ",", "36268", ",", "36272", ",", "36277", ",", "36280", ",", 
       "36537", ",", "36726", ",", "36937", ",", "36989", ",", "37126", ",", 
       "37143", ",", "37144", ",", "37145", ",", "37165", ",", "37225", ",", 
       "37228", ",", "37235", ",", "37244", ",", "37251", ",", "37259", ",", 
       "37263", ",", "37265", ",", "37268", ",", "37282", ",", "37290", ",", 
       "37296", ",", "37313", ",", "37394", ",", "37396", ",", "37441", ",", 
       "3764", ",", "38194", ",", "38263", ",", "38434", ",", "38473", ",", 
       "38481", ",", "38483", ",", "38484", ",", "38495", ",", "38500", ",", 
       "38503", ",", "38505", ",", "38525", ",", "38530", ",", "38546", ",", 
       "38559", ",", "38560", ",", "38567", ",", "38616", ",", "38617", ",", 
       "38620", ",", "38621", ",", "38627", ",", "38652", ",", "38662", ",", 
       "38666", ",", "38667", ",", "38678", ",", "38708", ",", "38717", ",", 
       "38722", ",", "38724", ",", "38747", ",", "38769", ",", "38773", ",", 
       "38778", ",", "38781", ",", "38789", ",", "38795", ",", "38805", ",", 
       "38819", ",", "38843", ",", "38846", ",", "38849", ",", "38855", ",", 
       "38878", ",", "38881", ",", "38894", ",", "38903", ",", "38937", ",", 
       "38952", ",", "38960", ",", "38961", ",", "38964", ",", "38984", ",", 
       "39001", ",", "39003", ",", "39007", ",", "39008", ",", "39015", ",", 
       "39017", ",", "39018", ",", "39020", ",", "39021", ",", "39024", ",", 
       "39030", ",", "39032", ",", "39034", ",", "39038", ",", "39039", ",", 
       "39089", ",", "39096", ",", "39129", ",", "39140", ",", "39156", ",", 
       "39166", ",", "39167", ",", "39171", ",", "39200", ",", "39201", ",", 
       "39206", ",", "39221", ",", "39225", ",", "39231", ",", "39234", ",", 
       "39238", ",", "39255", ",", "39257", ",", "39258", ",", "39262", ",", 
       "39268", ",", "39269", ",", "39272", ",", "39709", ",", "39717", ",", 
       "39734", ",", "39741", ",", "39747", ",", "39749", ",", "39753", ",", 
       "39755", ",", "39758", ",", "39789"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "<", 
       RowBox[{
        RowBox[{"Length", "[", "UCENumber", "]"}], "+", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ratevector", " ", "=", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{
             "\"\</home/psg/PSG/SignalNoise/MathematicaInputFiles/\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"UCENumber", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
              "\"\<.nex.rates.sites.Rates.txt\>\""}], ",", "\"\<CSV\>\""}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " ", "//", 
        RowBox[{
        "ToExpression", "\[IndentingNewLine]", "\n", "\n", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"ratevector", "[", 
           RowBox[{"[", "]"}], "]"}], "]"}]}]}], ";", "\n", 
       RowBox[{"internode", "=", 
        RowBox[{"{", 
         RowBox[{"27", ",", "120"}], "}"}]}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{"switches", "=", 
        RowBox[{"Import", "[", 
         RowBox[{"\"\</home/psg/PSG/SignalNoise/MathematicaInputFiles/\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"UCENumber", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
          "\"\<.nex.rates.sites.switches.txt\>\""}], "]"}]}], ";", "\n", 
       RowBox[{"StringToStream", "[", "switches", "]"}], ";", "\n", 
       RowBox[{"Get", "[", 
        RowBox[{"StringToStream", "[", "switches", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\n", 
       RowBox[{"ProbabilityOfEachBasePairType", "=", 
        RowBox[{"Import", "[", 
         RowBox[{"\"\</home/psg/PSG/SignalNoise/MathematicaInputFiles/\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"UCENumber", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
          "\"\<.nex.rates.sites.Percents.txt\>\""}], "]"}]}], ";", "\n", 
       RowBox[{"StringToStream", "[", "ProbabilityOfEachBasePairType", "]"}], 
       ";", "\n", 
       RowBox[{"Get", "[", 
        RowBox[{"StringToStream", "[", "ProbabilityOfEachBasePairType", "]"}],
         "]"}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{"\[Pi]T", "=", "piT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Pi]C", "=", "piC"}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"\[Pi]A", "=", "piA"}], " ", ";", "\[IndentingNewLine]", "\n", 
       "\n", 
       RowBox[{"\[Pi]G", "=", 
        RowBox[{"1", "-", "\[Pi]T", "-", "\[Pi]C", "-", "\[Pi]A"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a", "=", "rCT"}], ";", " ", 
       RowBox[{"b", "=", "rAT"}], ";", " ", 
       RowBox[{"c", "=", "rTG"}], ";", " ", 
       RowBox[{"d", "=", "rCA"}], ";", " ", 
       RowBox[{"e", "=", "rCG"}], ";", " ", 
       RowBox[{"f", "=", "rAG"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Mu]", "=", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "*", "\[Pi]T", "*", "\[Pi]C"}], "+", 
           RowBox[{"b", "*", "\[Pi]T", "*", "\[Pi]A"}], "+", 
           RowBox[{"c", "*", "\[Pi]T", "*", "\[Pi]G"}], "+", 
           RowBox[{"d", "*", "\[Pi]C", "*", "\[Pi]A"}], "+", 
           RowBox[{"e", "*", "\[Pi]C", "*", "\[Pi]G"}], "+", 
           RowBox[{"f", "*", "\[Pi]A", "*", "\[Pi]G"}]}], ")"}]}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"\[Mu]", "*", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "a"}], "*", "\[Pi]C"}], "-", 
              RowBox[{"b", "*", "\[Pi]A"}], "-", 
              RowBox[{"c", "*", "\[Pi]G"}]}], ",", 
             RowBox[{"a", "*", "\[Pi]C"}], ",", 
             RowBox[{"b", "*", "\[Pi]A"}], ",", 
             RowBox[{"c", "*", "\[Pi]G"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "*", "\[Pi]T"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "a"}], "*", "\[Pi]T"}], "-", 
              RowBox[{"d", "*", "\[Pi]A"}], "-", 
              RowBox[{"e", "*", "\[Pi]G"}]}], ",", 
             RowBox[{"d", "*", "\[Pi]A"}], ",", 
             RowBox[{"e", "*", "\[Pi]G"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"b", "*", "\[Pi]T"}], ",", 
             RowBox[{"d", "*", "\[Pi]C"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "b"}], "*", "\[Pi]T"}], "-", 
              RowBox[{"d", "*", "\[Pi]C"}], "-", 
              RowBox[{"f", "*", "\[Pi]G"}]}], ",", 
             RowBox[{"f", "*", "\[Pi]G"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "*", "\[Pi]T"}], ",", 
             RowBox[{"e", "*", "\[Pi]C"}], ",", 
             RowBox[{"f", "*", "\[Pi]A"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "c"}], "*", "\[Pi]T"}], "-", 
              RowBox[{"e", "*", "\[Pi]C"}], "-", 
              RowBox[{"f", "*", "\[Pi]A"}]}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Frequency", "=", 
        RowBox[{"{", 
         RowBox[{
         "\[Pi]T", ",", " ", "\[Pi]C", ",", " ", "\[Pi]A", ",", " ", 
          "\[Pi]G"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dev", "=", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Eigenvalues", "[", "Q", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tev", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Eigenvectors", "[", "Q", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"itev", "=", 
        RowBox[{"Inverse", "[", "tev", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"tev", ".", 
          RowBox[{"MatrixExp", "[", 
           RowBox[{"dev", "*", "\[Lambda]", "*", "t"}], "]"}], ".", "itev"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Po", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"tev", ".", 
          RowBox[{"MatrixExp", "[", 
           RowBox[{"dev", "*", "\[Lambda]", "*", "tnaught"}], "]"}], ".", 
          "itev"}], "]"}]}], ";", "\n", 
       RowBox[{"Correct", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Wrong1", "=", "0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"OriginalCharacter", "=", "1"}], ",", " ", 
         RowBox[{"OriginalCharacter", "\[LessEqual]", "4"}], ",", " ", 
         RowBox[{"OriginalCharacter", "++"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"InternodeCharacter", "=", "1"}], ",", " ", 
            RowBox[{"InternodeCharacter", "\[LessEqual]", "4"}], ",", " ", 
            RowBox[{"InternodeCharacter", "++"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"LeafCharacter1", "=", "1"}], ",", " ", 
               RowBox[{"LeafCharacter1", "\[LessEqual]", "4"}], ",", " ", 
               RowBox[{"LeafCharacter1", "++"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"LeafCharacter2", "=", "1"}], ",", " ", 
                  RowBox[{"LeafCharacter2", "\[LessEqual]", "4"}], ",", " ", 
                  RowBox[{"LeafCharacter2", "++"}], ",", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AddSum", "=", 
                    RowBox[{
                    RowBox[{"Frequency", "[", 
                    RowBox[{"[", "OriginalCharacter", "]"}], "]"}], "*", 
                    "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{"Po", "[", 
                    RowBox[{"[", 
                    RowBox[{"OriginalCharacter", ",", "InternodeCharacter"}], 
                    "]"}], "]"}], "*", "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"OriginalCharacter", ",", "LeafCharacter1"}], 
                    "]"}], "]"}], "^", "2"}], "*", "\[IndentingNewLine]", 
                    "\t", "\t", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"InternodeCharacter", ",", "LeafCharacter2"}], 
                    "]"}], "]"}], "^", "2"}], "*", "\[IndentingNewLine]", 
                    "\t", "\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"LeafCharacter1", "==", "LeafCharacter2"}], ",", 
                    "0", ",", "1"}], "]"}]}]}], ";", "\t", "\t", "\t", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Correct", "=", 
                    RowBox[{"Correct", "+", "AddSum"}]}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"AddSum2", "=", 
                    RowBox[{
                    RowBox[{"Frequency", "[", 
                    RowBox[{"[", "OriginalCharacter", "]"}], "]"}], "*", 
                    "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{"Po", "[", 
                    RowBox[{"[", 
                    RowBox[{"OriginalCharacter", ",", "InternodeCharacter"}], 
                    "]"}], "]"}], "*", "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"OriginalCharacter", ",", "LeafCharacter1"}], 
                    "]"}], "]"}], "*", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"OriginalCharacter", ",", "LeafCharacter2"}], 
                    "]"}], "]"}], "*", "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"InternodeCharacter", ",", "LeafCharacter1"}], 
                    "]"}], "]"}], "*", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"InternodeCharacter", ",", "LeafCharacter2"}], 
                    "]"}], "]"}], "*", "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"LeafCharacter1", "==", "LeafCharacter2"}], ",", 
                    "0", ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Wrong1", "=", 
                    RowBox[{"Wrong1", "+", "AddSum2"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}],
               "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", "\n", 
       RowBox[{"Y", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Correct", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t", "\[Rule]", 
             RowBox[{"internode", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
            RowBox[{"tnaught", " ", "\[Rule]", 
             RowBox[{"internode", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"X1", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Wrong1", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t", "\[Rule]", 
             RowBox[{"internode", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
            RowBox[{"tnaught", " ", "\[Rule]", 
             RowBox[{"internode", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\n", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"Length", "[", "ratevector", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", " ", 
         RowBox[{"j", "\[LessEqual]", "n"}], ",", " ", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"0", "<", 
              RowBox[{"ratevector", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "<", "0.2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"eYsum", "=", 
               RowBox[{"Y", "/.", 
                RowBox[{"\[Lambda]", "\[Rule]", 
                 RowBox[{"ratevector", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"eX1sum", "=", 
               RowBox[{"X1", "/.", 
                RowBox[{"\[Lambda]", "\[Rule]", 
                 RowBox[{"ratevector", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"eY2sum", " ", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Y", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"Y", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"eX12sum", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"X1", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"X1", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"eX1Ysum", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"X1", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"Y", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"expectation", " ", "=", " ", 
               RowBox[{"eYsum", "-", 
                RowBox[{"(", 
                 RowBox[{"eX1sum", "+", 
                  SqrtBox[
                   RowBox[{"eX1sum", "/", "Pi"}]]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"variance", "=", 
               RowBox[{"eYsum", "-", "eY2sum", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Pi", "-", "1"}], ")"}], "/", "Pi"}], ")"}], "*", 
                 "eX1sum"}], "-", "eX12sum", "+", 
                RowBox[{"2", "*", "eX1Ysum"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"ratevector", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "expectation", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               SqrtBox["variance"], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"ndist", " ", "=", " ", 
               RowBox[{"NormalDistribution", "[", 
                RowBox[{"expectation", ",", " ", 
                 SqrtBox["variance"]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"NormalDistribution", "[", 
                RowBox[{"expectation", ",", " ", 
                 SqrtBox["variance"]}], "]"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "ndist", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"princtree", " ", "=", " ", 
               RowBox[{"N", "[", 
                RowBox[{"CDF", "[", 
                 RowBox[{"ndist", ",", " ", 
                  RowBox[{"-", "0.5"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"N", "[", 
                RowBox[{"CDF", "[", 
                 RowBox[{"ndist", ",", 
                  RowBox[{"-", "0.5"}]}], "]"}], "]"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "princtree", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"prpolytomy", "=", " ", 
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{"CDF", "[", 
                  RowBox[{"ndist", ",", " ", "0.5"}], "]"}], "]"}], "-", 
                RowBox[{"N", "[", 
                 RowBox[{"CDF", "[", 
                  RowBox[{"ndist", ",", " ", 
                   RowBox[{"-", "0.5"}]}], "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"prcortree", "=", " ", 
               RowBox[{"1", "-", 
                RowBox[{"N", "[", 
                 RowBox[{"CDF", "[", 
                  RowBox[{"ndist", ",", " ", "0.5"}], "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{
                "\"\</home/psg/PSG/SignalNoise/MathematicaOutputFiles_C_3/\>\"\
", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"UCENumber", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
                 "\"\<_site_\>\"", "<>", 
                 RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<.csv\>\""}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"UCENumber", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j", ",", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], " ", ",", "princtree", 
                   ",", " ", "prpolytomy", ",", " ", "prcortree", ",", 
                   "\"\<\\n\>\""}], "}"}], "}"}]}], "]"}]}]}], "]"}], ",", 
           "1"}], "]"}]}], "]"}], ";"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.667851043653088*^9, 3.667851058186928*^9}, {
   3.667851111549633*^9, 3.667851122103951*^9}, {3.667851166552779*^9, 
   3.667851272964541*^9}, {3.667851556597699*^9, 3.6678515588627234`*^9}, {
   3.667851734199095*^9, 3.667851777798177*^9}, {3.667851878026458*^9, 
   3.667851882790975*^9}, 3.6678553547188053`*^9, {3.667855407210354*^9, 
   3.6678554196156063`*^9}, 3.667855518786419*^9, {3.667855996493533*^9, 
   3.6678560002998457`*^9}, {3.6678565944942703`*^9, 3.66785660221099*^9}, {
   3.66785681788013*^9, 3.667856822449668*^9}, {3.668612816167575*^9, 
   3.668612858777959*^9}, {3.668613833284832*^9, 3.668613937988901*^9}, {
   3.668614064621889*^9, 3.6686140930244017`*^9}, 3.668614400028338*^9, {
   3.6686164120792847`*^9, 3.668616461349169*^9}, {3.668616519704609*^9, 
   3.668616566276775*^9}, {3.668616608905406*^9, 3.668616623521987*^9}, 
   3.668616660589353*^9, {3.668806807466546*^9, 3.6688068096791487`*^9}, {
   3.6688072024754744`*^9, 3.66880720340959*^9}, {3.6688081410058804`*^9, 
   3.668808161700914*^9}, {3.668808414578002*^9, 3.66880841582244*^9}, {
   3.66880876719718*^9, 3.668808790914229*^9}, {3.668897838163889*^9, 
   3.668897874966785*^9}, {3.66889813740131*^9, 3.668898140239345*^9}, 
   3.6688982875698853`*^9, 3.668898355541563*^9, {3.669327920603245*^9, 
   3.6693279220866003`*^9}, {3.669328589484429*^9, 3.669328624823166*^9}, 
   3.669330385099065*^9, {3.669334000036912*^9, 3.6693340040645247`*^9}, {
   3.669334129618062*^9, 3.6693341498457813`*^9}, {3.6693343752702503`*^9, 
   3.669334393867136*^9}, 3.6693364653750267`*^9, 3.671308460083831*^9, {
   3.671308494220911*^9, 3.671308495506646*^9}, {3.67130897088902*^9, 
   3.671308975799487*^9}, 3.676936591106534*^9, {3.676936624450922*^9, 
   3.6769366263063173`*^9}, {3.676936669284968*^9, 3.676936695878952*^9}, {
   3.676936759946826*^9, 3.676936762270632*^9}, {3.676936929914119*^9, 
   3.6769369299882183`*^9}}]
},
WindowSize->{1280, 752},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 29, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 29044, 563, 2378, "Input"]
}
]
*)

(* End of internal cache information *)
