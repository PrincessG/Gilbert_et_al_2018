(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33391,        644]
NotebookOptionsPosition[     33137,        630]
NotebookOutlinePosition[     33490,        646]
CellTagsIndexPosition[     33447,        643]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"UCENumber", "=", 
     RowBox[{"{", 
      RowBox[{
      "410149", ",", "410251", ",", "410295", ",", "410528", ",", "410530", 
       ",", "410540", ",", "410567", ",", "410574", ",", "410583", ",", 
       "410612", ",", "411164", ",", "411305", ",", "412625", ",", "413270", 
       ",", "413330", ",", "413362", ",", "413367", ",", "413384", ",", 
       "413387", ",", "413397", ",", "413403", ",", "413410", ",", "413413", 
       ",", "413425", ",", "413431", ",", "413667", ",", "413964", ",", 
       "414149", ",", "41464", ",", "415363", ",", "415987", ",", "416026", 
       ",", "416749", ",", "416780", ",", "416878", ",", "417300", ",", 
       "417356", ",", "417375", ",", "417431", ",", "417445", ",", "417508", 
       ",", "417511", ",", "417854", ",", "417860", ",", "417870", ",", 
       "418003", ",", "418217", ",", "418580", ",", "4188", ",", "418911", 
       ",", "418918", ",", "418926", ",", "418929", ",", "418946", ",", 
       "418956", ",", "418964", ",", "418977", ",", "418991", ",", "42364", 
       ",", "42423", ",", "42427", ",", "42564", ",", "42590", ",", "42604", 
       ",", "42614", ",", "42641", ",", "42644", ",", "42664", ",", "42986", 
       ",", "43296", ",", "4410206", ",", "4411933", ",", "441831", ",", 
       "442974", ",", "443368", ",", "446595", ",", "446596", ",", "44785", 
       ",", "447943", ",", "448931", ",", "44926", ",", "449491", ",", 
       "44979", ",", "449879", ",", "46289", ",", "46508", ",", "46659", ",", 
       "46701", ",", "46778", ",", "47006", ",", "47028", ",", "47192", ",", 
       "47250", ",", "47258", ",", "47278", ",", "47282", ",", "47284", ",", 
       "47423", ",", "47513", ",", "47516", ",", "47523", ",", "47551", ",", 
       "47559", ",", "47565", ",", "47577", ",", "47591", ",", "47606", ",", 
       "48670", ",", "48796", ",", "48888", ",", "48913", ",", "48915", ",", 
       "4894", ",", "49220", ",", "49338", ",", "49344", ",", "49348", ",", 
       "49353", ",", "49373", ",", "49382", ",", "49386", ",", "49394", ",", 
       "49401", ",", "49408", ",", "49444", ",", "49448", ",", "49455", ",", 
       "49461", ",", "49462", ",", "49464", ",", "49503", ",", "49521", ",", 
       "49525", ",", "49576", ",", "49639", ",", "49650", ",", "49653", ",", 
       "49657", ",", "49668", ",", "49669", ",", "49672", ",", "49680", ",", 
       "49711", ",", "49721", ",", "49725", ",", "49726", ",", "49731", ",", 
       "49744", ",", "49749", ",", "49754", ",", "49763", ",", "49765", ",", 
       "49776", ",", "49779", ",", "49780", ",", "49786", ",", "49789", ",", 
       "49794", ",", "49797", ",", "49809", ",", "49813", ",", "49821", ",", 
       "49834", ",", "49839", ",", "49859", ",", "49954", ",", "510051", ",", 
       "510052", ",", "510086", ",", "510110", ",", "510115", ",", "510135", 
       ",", "510160", ",", "510164", ",", "510166", ",", "510173", ",", 
       "510176", ",", "510180", ",", "510200", ",", "510203", ",", "510244", 
       ",", "510262", ",", "510266", ",", "510292", ",", "510296", ",", 
       "510326", ",", "510327", ",", "510331", ",", "510367", ",", "510375", 
       ",", "510377", ",", "510383", ",", "510384", ",", "510406", ",", 
       "510412", ",", "510416", ",", "510419", ",", "510443", ",", "510451", 
       ",", "510541", ",", "510555", ",", "51055", ",", "510566", ",", 
       "510569", ",", "51056", ",", "510576", ",", "510579", ",", "51057", 
       ",", "510583", ",", "510587", ",", "510611", ",", "510614", ",", 
       "510615", ",", "510617", ",", "51064", ",", "510656", ",", "510687", 
       ",", "510691", ",", "510696", ",", "510704", ",", "510725", ",", 
       "510726", ",", "510730", ",", "510787", ",", "510793", ",", "510794", 
       ",", "510797", ",", "510804", ",", "510841", ",", "510854", ",", 
       "510859", ",", "510904", ",", "510912", ",", "510985", ",", "511018", 
       ",", "511146", ",", "511147", ",", "511157", ",", "511168", ",", 
       "511170", ",", "511194", ",", "511197", ",", "511202", ",", "511206", 
       ",", "511211", ",", "511214", ",", "511219", ",", "511226", ",", 
       "511231", ",", "511238", ",", "511239", ",", "511240", ",", "511242", 
       ",", "511244", ",", "511245", ",", "511247", ",", "511258", ",", 
       "511266", ",", "511269", ",", "511276", ",", "511286", ",", "511293", 
       ",", "511301", ",", "511302", ",", "511304", ",", "511306", ",", 
       "511323", ",", "511333", ",", "511334", ",", "511339", ",", "511342", 
       ",", "511359", ",", "511362", ",", "511414", ",", "511534", ",", 
       "511538", ",", "511657", ",", "511660", ",", "511783", ",", "511822", 
       ",", "512018", ",", "512347", ",", "512349", ",", "512369", ",", 
       "512374", ",", "512392", ",", "512397", ",", "512400", ",", "512404", 
       ",", "512459", ",", "512464", ",", "512549", ",", "512835", ",", 
       "513040", ",", "513733", ",", "513735", ",", "514383", ",", "514386", 
       ",", "514389", ",", "514398", ",", "514620", ",", "514621", ",", 
       "514623", ",", "514632", ",", "514664", ",", "514672", ",", "514678", 
       ",", "514679", ",", "514682", ",", "514683", ",", "514690", ",", 
       "514702", ",", "514703", ",", "514708", ",", "514718", ",", "514720", 
       ",", "514727", ",", "514754", ",", "514763", ",", "514778", ",", 
       "514781", ",", "514830", ",", "514846", ",", "514864", ",", "514867", 
       ",", "514872", ",", "514876", ",", "514922", ",", "514963", ",", 
       "515022", ",", "515030", ",", "515064", ",", "515069", ",", "515073", 
       ",", "515083", ",", "515086", ",", "515102", ",", "515106", ",", 
       "515107", ",", "515939", ",", "51597", ",", "516011", ",", "516019", 
       ",", "51674", ",", "51675", ",", "51689", ",", "516904", ",", "51701", 
       ",", "51706", ",", "51718", ",", "51737", ",", "51747", ",", "51788", 
       ",", "51796", ",", "51800", ",", "518035", ",", "51813", ",", "51836", 
       ",", "51839", ",", "52308", ",", "52918", ",", "52925", ",", "52947", 
       ",", "52960", ",", "52962", ",", "52964", ",", "52978", ",", "52984", 
       ",", "53001", ",", "53014", ",", "53024", ",", "53025", ",", "53033", 
       ",", "53040", ",", "53167", ",", "53181", ",", "53186", ",", "53194", 
       ",", "53204", ",", "53213", ",", "53223", ",", "53243", ",", "53255", 
       ",", "53280", ",", "53294", ",", "53295", ",", "53310", ",", "53312", 
       ",", "53325", ",", "53328", ",", "53332", ",", "53341", ",", "53342", 
       ",", "53353", ",", "53384", ",", "53393", ",", "53405", ",", "53425", 
       ",", "53446", ",", "53487", ",", "5355", ",", "53756", ",", "55571", 
       ",", "55591", ",", "55596", ",", "55674", ",", "55841", ",", "55845", 
       ",", "55848", ",", "55859", ",", "56551", ",", "57221", ",", "57820", 
       ",", "57879", ",", "58057", ",", "59279", ",", "59556", ",", "59559", 
       ",", "59863", ",", "59866", ",", "59877", ",", "59881", ",", "59883", 
       ",", "610010", ",", "610018", ",", "610033", ",", "610056", ",", 
       "610759", ",", "610763", ",", "610764", ",", "610771", ",", "610779", 
       ",", "610786", ",", "610789", ",", "610794", ",", "610800", ",", 
       "610816", ",", "610831", ",", "610836", ",", "610845", ",", "610846", 
       ",", "610847", ",", "610852", ",", "610902", ",", "610922", ",", 
       "610924", ",", "610938", ",", "610944", ",", "610947", ",", "610950", 
       ",", "610956", ",", "610961", ",", "610965", ",", "610968", ",", 
       "610984", ",", "610989", ",", "611011", ",", "611012", ",", "611018", 
       ",", "611022", ",", "611023", ",", "611039", ",", "611044", ",", 
       "611046", ",", "611063", ",", "611067", ",", "611097", ",", "611099", 
       ",", "611104", ",", "611109", ",", "611111", ",", "611115", ",", 
       "611127", ",", "611129", ",", "611130", ",", "611135", ",", "611139", 
       ",", "611141", ",", "611143", ",", "611152", ",", "611163", ",", 
       "611174", ",", "611178", ",", "611179", ",", "611195", ",", "611196", 
       ",", "611204", ",", "611213", ",", "611239", ",", "611241", ",", 
       "611243", ",", "611250", ",", "611251", ",", "611267", ",", "611269", 
       ",", "611286", ",", "611297", ",", "611298", ",", "611303", ",", 
       "611315", ",", "61336", ",", "61423", ",", "61542", ",", "61544", ",", 
       "61554", ",", "6169", ",", "61992", ",", "62779", ",", "62814", ",", 
       "6283", ",", "62875", ",", "63018", ",", "63045", ",", "63086", ",", 
       "63102", ",", "63116", ",", "63134", ",", "63138", ",", "63147", ",", 
       "63161", ",", "63170", ",", "63178", ",", "63196", ",", "63198", ",", 
       "63211", ",", "63215", ",", "63217", ",", "63219", ",", "63224", ",", 
       "63230", ",", "63247", ",", "63251", ",", "63255", ",", "63256", ",", 
       "63257", ",", "63258", ",", "63262", ",", "63265", ",", "63270", ",", 
       "63272", ",", "63275", ",", "63284", ",", "63291", ",", "63324", ",", 
       "63326", ",", "63357", ",", "63430", ",", "63939", ",", "64027", ",", 
       "64057", ",", "64059", ",", "64081", ",", "64086", ",", "64094", ",", 
       "64101", ",", "64104", ",", "64107", ",", "64109", ",", "64112", ",", 
       "64115", ",", "64116", ",", "64118", ",", "64125", ",", "64126", ",", 
       "64131", ",", "64139", ",", "64403", ",", "64409", ",", "64956", ",", 
       "65079", ",", "65085", ",", "65297", ",", "65852", ",", "65890", ",", 
       "65902", ",", "65962", ",", "65967", ",", "65970", ",", "65980", ",", 
       "65999", ",", "6628", ",", "67105", ",", "67106", ",", "67111", ",", 
       "67113", ",", "67124", ",", "67142", ",", "67143", ",", "67175", ",", 
       "67181", ",", "67185", ",", "67188", ",", "67190", ",", "67207", ",", 
       "67239", ",", "67275", ",", "67277", ",", "67323", ",", "67324", ",", 
       "67340", ",", "67868", ",", "67943", ",", "67959", ",", "67972", ",", 
       "68017", ",", "68088", ",", "6824", ",", "68742", ",", "68744", ",", 
       "68771", ",", "68801", ",", "68806", ",", "68822", ",", "68827", ",", 
       "68828", ",", "68836", ",", "69024", ",", "69069", ",", "69092", ",", 
       "69447", ",", "69464", ",", "69474", ",", "69484", ",", "69493", ",", 
       "69502", ",", "69522", ",", "69527", ",", "69557", ",", "69562", ",", 
       "69574", ",", "69592", ",", "69594", ",", "69601", ",", "69615", ",", 
       "69631", ",", "69632", ",", "69634", ",", "69640", ",", "69671", ",", 
       "69679", ",", "69686", ",", "69701", ",", "69702", ",", "69706", ",", 
       "69733", ",", "69743", ",", "69746", ",", "69756", ",", "69760", ",", 
       "69762", ",", "69784", ",", "69787", ",", "69788", ",", "69789", ",", 
       "69797", ",", "69798", ",", "69799", ",", "69804", ",", "69808", ",", 
       "69811"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "<", 
       RowBox[{
        RowBox[{"Length", "[", "UCENumber", "]"}], "+", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ratevector", " ", "=", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{
             "\"\</home/psg/PSG/SignalNoise/MathematicaInputFiles/\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"UCENumber", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
              "\"\<.nex.rates.sites.Rates.txt\>\""}], ",", "\"\<CSV\>\""}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " ", "//", 
        RowBox[{
        "ToExpression", "\[IndentingNewLine]", "\n", "\n", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"ratevector", "[", 
           RowBox[{"[", "]"}], "]"}], "]"}]}]}], ";", "\n", 
       RowBox[{"internode", "=", 
        RowBox[{"{", 
         RowBox[{"27", ",", "120"}], "}"}]}], ";", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{"switches", "=", 
        RowBox[{"Import", "[", 
         RowBox[{"\"\</home/psg/PSG/SignalNoise/MathematicaInputFiles/\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"UCENumber", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
          "\"\<.nex.rates.sites.switches.txt\>\""}], "]"}]}], ";", "\n", 
       RowBox[{"StringToStream", "[", "switches", "]"}], ";", "\n", 
       RowBox[{"Get", "[", 
        RowBox[{"StringToStream", "[", "switches", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\n", 
       RowBox[{"ProbabilityOfEachBasePairType", "=", 
        RowBox[{"Import", "[", 
         RowBox[{"\"\</home/psg/PSG/SignalNoise/MathematicaInputFiles/\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"UCENumber", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
          "\"\<.nex.rates.sites.Percents.txt\>\""}], "]"}]}], ";", "\n", 
       RowBox[{"StringToStream", "[", "ProbabilityOfEachBasePairType", "]"}], 
       ";", "\n", 
       RowBox[{"Get", "[", 
        RowBox[{"StringToStream", "[", "ProbabilityOfEachBasePairType", "]"}],
         "]"}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{"\[Pi]T", "=", "piT"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Pi]C", "=", "piC"}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"\[Pi]A", "=", "piA"}], " ", ";", "\[IndentingNewLine]", "\n", 
       "\n", 
       RowBox[{"\[Pi]G", "=", 
        RowBox[{"1", "-", "\[Pi]T", "-", "\[Pi]C", "-", "\[Pi]A"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a", "=", "rCT"}], ";", " ", 
       RowBox[{"b", "=", "rAT"}], ";", " ", 
       RowBox[{"c", "=", "rTG"}], ";", " ", 
       RowBox[{"d", "=", "rCA"}], ";", " ", 
       RowBox[{"e", "=", "rCG"}], ";", " ", 
       RowBox[{"f", "=", "rAG"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Mu]", "=", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "*", "\[Pi]T", "*", "\[Pi]C"}], "+", 
           RowBox[{"b", "*", "\[Pi]T", "*", "\[Pi]A"}], "+", 
           RowBox[{"c", "*", "\[Pi]T", "*", "\[Pi]G"}], "+", 
           RowBox[{"d", "*", "\[Pi]C", "*", "\[Pi]A"}], "+", 
           RowBox[{"e", "*", "\[Pi]C", "*", "\[Pi]G"}], "+", 
           RowBox[{"f", "*", "\[Pi]A", "*", "\[Pi]G"}]}], ")"}]}]}], ";", " ",
        "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"\[Mu]", "*", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "a"}], "*", "\[Pi]C"}], "-", 
              RowBox[{"b", "*", "\[Pi]A"}], "-", 
              RowBox[{"c", "*", "\[Pi]G"}]}], ",", 
             RowBox[{"a", "*", "\[Pi]C"}], ",", 
             RowBox[{"b", "*", "\[Pi]A"}], ",", 
             RowBox[{"c", "*", "\[Pi]G"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "*", "\[Pi]T"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "a"}], "*", "\[Pi]T"}], "-", 
              RowBox[{"d", "*", "\[Pi]A"}], "-", 
              RowBox[{"e", "*", "\[Pi]G"}]}], ",", 
             RowBox[{"d", "*", "\[Pi]A"}], ",", 
             RowBox[{"e", "*", "\[Pi]G"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"b", "*", "\[Pi]T"}], ",", 
             RowBox[{"d", "*", "\[Pi]C"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "b"}], "*", "\[Pi]T"}], "-", 
              RowBox[{"d", "*", "\[Pi]C"}], "-", 
              RowBox[{"f", "*", "\[Pi]G"}]}], ",", 
             RowBox[{"f", "*", "\[Pi]G"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "*", "\[Pi]T"}], ",", 
             RowBox[{"e", "*", "\[Pi]C"}], ",", 
             RowBox[{"f", "*", "\[Pi]A"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "c"}], "*", "\[Pi]T"}], "-", 
              RowBox[{"e", "*", "\[Pi]C"}], "-", 
              RowBox[{"f", "*", "\[Pi]A"}]}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Frequency", "=", 
        RowBox[{"{", 
         RowBox[{
         "\[Pi]T", ",", " ", "\[Pi]C", ",", " ", "\[Pi]A", ",", " ", 
          "\[Pi]G"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dev", "=", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Eigenvalues", "[", "Q", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tev", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Eigenvectors", "[", "Q", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"itev", "=", 
        RowBox[{"Inverse", "[", "tev", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"tev", ".", 
          RowBox[{"MatrixExp", "[", 
           RowBox[{"dev", "*", "\[Lambda]", "*", "t"}], "]"}], ".", "itev"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Po", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"tev", ".", 
          RowBox[{"MatrixExp", "[", 
           RowBox[{"dev", "*", "\[Lambda]", "*", "tnaught"}], "]"}], ".", 
          "itev"}], "]"}]}], ";", "\n", 
       RowBox[{"Correct", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Wrong1", "=", "0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"OriginalCharacter", "=", "1"}], ",", " ", 
         RowBox[{"OriginalCharacter", "\[LessEqual]", "4"}], ",", " ", 
         RowBox[{"OriginalCharacter", "++"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"InternodeCharacter", "=", "1"}], ",", " ", 
            RowBox[{"InternodeCharacter", "\[LessEqual]", "4"}], ",", " ", 
            RowBox[{"InternodeCharacter", "++"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"LeafCharacter1", "=", "1"}], ",", " ", 
               RowBox[{"LeafCharacter1", "\[LessEqual]", "4"}], ",", " ", 
               RowBox[{"LeafCharacter1", "++"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"LeafCharacter2", "=", "1"}], ",", " ", 
                  RowBox[{"LeafCharacter2", "\[LessEqual]", "4"}], ",", " ", 
                  RowBox[{"LeafCharacter2", "++"}], ",", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AddSum", "=", 
                    RowBox[{
                    RowBox[{"Frequency", "[", 
                    RowBox[{"[", "OriginalCharacter", "]"}], "]"}], "*", 
                    "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{"Po", "[", 
                    RowBox[{"[", 
                    RowBox[{"OriginalCharacter", ",", "InternodeCharacter"}], 
                    "]"}], "]"}], "*", "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"OriginalCharacter", ",", "LeafCharacter1"}], 
                    "]"}], "]"}], "^", "2"}], "*", "\[IndentingNewLine]", 
                    "\t", "\t", 
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"InternodeCharacter", ",", "LeafCharacter2"}], 
                    "]"}], "]"}], "^", "2"}], "*", "\[IndentingNewLine]", 
                    "\t", "\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"LeafCharacter1", "==", "LeafCharacter2"}], ",", 
                    "0", ",", "1"}], "]"}]}]}], ";", "\t", "\t", "\t", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Correct", "=", 
                    RowBox[{"Correct", "+", "AddSum"}]}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"AddSum2", "=", 
                    RowBox[{
                    RowBox[{"Frequency", "[", 
                    RowBox[{"[", "OriginalCharacter", "]"}], "]"}], "*", 
                    "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{"Po", "[", 
                    RowBox[{"[", 
                    RowBox[{"OriginalCharacter", ",", "InternodeCharacter"}], 
                    "]"}], "]"}], "*", "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"OriginalCharacter", ",", "LeafCharacter1"}], 
                    "]"}], "]"}], "*", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"OriginalCharacter", ",", "LeafCharacter2"}], 
                    "]"}], "]"}], "*", "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"InternodeCharacter", ",", "LeafCharacter1"}], 
                    "]"}], "]"}], "*", 
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"InternodeCharacter", ",", "LeafCharacter2"}], 
                    "]"}], "]"}], "*", "\[IndentingNewLine]", "\t", "\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"LeafCharacter1", "==", "LeafCharacter2"}], ",", 
                    "0", ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Wrong1", "=", 
                    RowBox[{"Wrong1", "+", "AddSum2"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}],
               "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", "\n", 
       RowBox[{"Y", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Correct", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t", "\[Rule]", 
             RowBox[{"internode", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
            RowBox[{"tnaught", " ", "\[Rule]", 
             RowBox[{"internode", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"X1", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Wrong1", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t", "\[Rule]", 
             RowBox[{"internode", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
            RowBox[{"tnaught", " ", "\[Rule]", 
             RowBox[{"internode", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\n", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"Length", "[", "ratevector", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", " ", 
         RowBox[{"j", "\[LessEqual]", "n"}], ",", " ", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"0", "<", 
              RowBox[{"ratevector", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "<", "0.2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"eYsum", "=", 
               RowBox[{"Y", "/.", 
                RowBox[{"\[Lambda]", "\[Rule]", 
                 RowBox[{"ratevector", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"eX1sum", "=", 
               RowBox[{"X1", "/.", 
                RowBox[{"\[Lambda]", "\[Rule]", 
                 RowBox[{"ratevector", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"eY2sum", " ", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Y", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"Y", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"eX12sum", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"X1", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"X1", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"eX1Ysum", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"X1", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"Y", "/.", 
                  RowBox[{"\[Lambda]", "\[Rule]", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"expectation", " ", "=", " ", 
               RowBox[{"eYsum", "-", 
                RowBox[{"(", 
                 RowBox[{"eX1sum", "+", 
                  SqrtBox[
                   RowBox[{"eX1sum", "/", "Pi"}]]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"variance", "=", 
               RowBox[{"eYsum", "-", "eY2sum", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Pi", "-", "1"}], ")"}], "/", "Pi"}], ")"}], "*", 
                 "eX1sum"}], "-", "eX12sum", "+", 
                RowBox[{"2", "*", "eX1Ysum"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"ratevector", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "expectation", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               SqrtBox["variance"], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"ndist", " ", "=", " ", 
               RowBox[{"NormalDistribution", "[", 
                RowBox[{"expectation", ",", " ", 
                 SqrtBox["variance"]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"NormalDistribution", "[", 
                RowBox[{"expectation", ",", " ", 
                 SqrtBox["variance"]}], "]"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "ndist", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"princtree", " ", "=", " ", 
               RowBox[{"N", "[", 
                RowBox[{"CDF", "[", 
                 RowBox[{"ndist", ",", " ", 
                  RowBox[{"-", "0.5"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"N", "[", 
                RowBox[{"CDF", "[", 
                 RowBox[{"ndist", ",", 
                  RowBox[{"-", "0.5"}]}], "]"}], "]"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "princtree", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"prpolytomy", "=", " ", 
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{"CDF", "[", 
                  RowBox[{"ndist", ",", " ", "0.5"}], "]"}], "]"}], "-", 
                RowBox[{"N", "[", 
                 RowBox[{"CDF", "[", 
                  RowBox[{"ndist", ",", " ", 
                   RowBox[{"-", "0.5"}]}], "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"prcortree", "=", " ", 
               RowBox[{"1", "-", 
                RowBox[{"N", "[", 
                 RowBox[{"CDF", "[", 
                  RowBox[{"ndist", ",", " ", "0.5"}], "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{
                "\"\</home/psg/PSG/SignalNoise/MathematicaOutputFiles_C_4/\>\"\
", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"UCENumber", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
                 "\"\<_site_\>\"", "<>", 
                 RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<.csv\>\""}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"UCENumber", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j", ",", 
                   RowBox[{"ratevector", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], " ", ",", "princtree", 
                   ",", " ", "prpolytomy", ",", " ", "prcortree", ",", 
                   "\"\<\\n\>\""}], "}"}], "}"}]}], "]"}]}]}], "]"}], ",", 
           "1"}], "]"}]}], "]"}], ";"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.667851043653088*^9, 3.667851058186928*^9}, {
   3.667851111549633*^9, 3.667851122103951*^9}, {3.667851166552779*^9, 
   3.667851272964541*^9}, {3.667851556597699*^9, 3.6678515588627234`*^9}, {
   3.667851734199095*^9, 3.667851777798177*^9}, {3.667851878026458*^9, 
   3.667851882790975*^9}, 3.6678553547188053`*^9, {3.667855407210354*^9, 
   3.6678554196156063`*^9}, 3.667855518786419*^9, {3.667855996493533*^9, 
   3.6678560002998457`*^9}, {3.6678565944942703`*^9, 3.66785660221099*^9}, {
   3.66785681788013*^9, 3.667856822449668*^9}, {3.668612816167575*^9, 
   3.668612858777959*^9}, {3.668613833284832*^9, 3.668613937988901*^9}, {
   3.668614064621889*^9, 3.6686140930244017`*^9}, 3.668614400028338*^9, {
   3.6686164120792847`*^9, 3.668616461349169*^9}, {3.668616519704609*^9, 
   3.668616566276775*^9}, {3.668616608905406*^9, 3.668616623521987*^9}, 
   3.668616660589353*^9, {3.668806807466546*^9, 3.6688068096791487`*^9}, {
   3.6688072024754744`*^9, 3.66880720340959*^9}, {3.6688081410058804`*^9, 
   3.668808161700914*^9}, {3.668808414578002*^9, 3.66880841582244*^9}, {
   3.66880876719718*^9, 3.668808790914229*^9}, {3.668897838163889*^9, 
   3.668897874966785*^9}, {3.66889813740131*^9, 3.668898140239345*^9}, 
   3.6688982875698853`*^9, 3.668898355541563*^9, {3.669327920603245*^9, 
   3.6693279220866003`*^9}, {3.669328589484429*^9, 3.669328624823166*^9}, 
   3.669330385099065*^9, {3.669334000036912*^9, 3.6693340040645247`*^9}, {
   3.669334129618062*^9, 3.6693341498457813`*^9}, {3.6693343752702503`*^9, 
   3.669334393867136*^9}, 3.6693364653750267`*^9, 3.671308460083831*^9, {
   3.671308494220911*^9, 3.671308495506646*^9}, {3.67130897088902*^9, 
   3.671308975799487*^9}, 3.676936591106534*^9, {3.676936624450922*^9, 
   3.6769366263063173`*^9}, {3.676936669284968*^9, 3.676936695878952*^9}, {
   3.676936759946826*^9, 3.676936762270632*^9}, {3.676936797411625*^9, 
   3.676936866096994*^9}}]
},
WindowSize->{1280, 752},
WindowMargins->{{7, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 29, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 32575, 608, 2599, "Input"]
}
]
*)

(* End of internal cache information *)
